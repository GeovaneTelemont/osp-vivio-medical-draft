# üß† Automa√ß√£o OSP Vivo (Playwright + Python)

Este projeto automatiza a coleta de dados do sistema **OSP Control** da Vivo, utilizando **Playwright** em modo s√≠ncrono com **Python**.  
O script realiza login (com suporte a CAPTCHA manual), acessa p√°ginas espec√≠ficas, extrai tabelas de medi√ß√µes e salva os resultados em um arquivo **CSV**.

---

## üöÄ Funcionalidades

- Login automatizado com suporte para login manual em caso de CAPTCHA.  
- Reaproveitamento de sess√£o autenticada (`auth.json`) para evitar logins repetidos.  
- Leitura de uma lista de IDs a partir de um arquivo CSV (`lista_csv/lista.csv`).  
- Navega√ß√£o autom√°tica at√© a aba **Medi√ß√£o ‚Üí Servi√ßos** de cada requisi√ß√£o.  
- Extra√ß√£o estruturada de tabelas (colunas e valores).  
- Salvamento dos dados coletados no arquivo `osp_vivo.csv`.  

---

## üß© Estrutura do Projeto

```
üìÇ projeto/
‚îÇ
‚îú‚îÄ‚îÄ main.py                 # Script principal
‚îú‚îÄ‚îÄ auth.json               # Sess√£o de login (gerada automaticamente)
‚îú‚îÄ‚îÄ osp_vivo.csv            # Sa√≠da dos dados coletados
‚îú‚îÄ‚îÄ lista_csv/
‚îÇ   ‚îî‚îÄ‚îÄ lista.csv           # Lista de IDs ou URLs a processar
‚îî‚îÄ‚îÄ requirements.txt        # Depend√™ncias do projeto
```

---

## üì¶ Requisitos

### Python
- Vers√£o **3.9+**

### Bibliotecas
Instale as depend√™ncias com:

```bash
pip install playwright pandas
```

E inicialize o navegador Chromium (necess√°rio apenas uma vez):

```bash
playwright install chromium
```

---

## ‚öôÔ∏è Configura√ß√£o

1. **Defina as credenciais**  
   No in√≠cio do arquivo `main.py`, preencha as vari√°veis:
   ```python
   USERNAME = "seu_usuario"
   PASSWORD = "sua_senha"
   ```

   > üí° Por seguran√ßa, o script solicita que o usu√°rio complete o CAPTCHA manualmente durante o primeiro login.

2. **Prepare o arquivo de entrada**  
   No diret√≥rio `lista_csv`, crie um arquivo chamado `lista.csv` com o seguinte formato:
   ```csv
   ID;OSP MEDIDO;url
   12345;PB Classe A;https://devopsredes.vivo.com.br/ospcontrol/requisicoes-eps?id=12345
   67890;PB Classe B;https://devopsredes.vivo.com.br/ospcontrol/requisicoes-eps?id=67890
   ```

3. **Execute o script**
   ```bash
   python main.py
   ```

4. **Ap√≥s o login manual**, o script:
   - Detecta a autentica√ß√£o,
   - Salva a sess√£o em `auth.json`,
   - E continua automaticamente o processamento dos IDs da lista.

---

## üóÇÔ∏è Sa√≠da Gerada

Os dados extra√≠dos s√£o salvos em `osp_vivo.csv`, com as seguintes colunas:

| ID | C√ìDIGO | DESCRI√á√ÉO DOS SERVI√áOS | QUANTIDADE | PRE√áO UNIT√ÅRIO | UNIDADE | PRE√áO TOTAL |
|----|---------|------------------------|-------------|----------------|----------|--------------|

Cada execu√ß√£o adiciona novas linhas ao arquivo sem sobrescrever os dados anteriores.

---

## üß∞ Principais Fun√ß√µes

| Fun√ß√£o | Descri√ß√£o |
|--------|------------|
| `read_csv_id()` | L√™ o arquivo `lista.csv` com IDs/URLs a processar |
| `login(page)` | Realiza o login manual assistido (usu√°rio e senha preenchidos automaticamente) |
| `is_logged(page)` | Verifica se h√° sess√£o ativa |
| `pesquisar_id(page, id)` | Navega at√© o ID informado e coleta os dados da tabela de servi√ßos |
| `main()` | Controla o fluxo principal da automa√ß√£o |

---

## ‚ö†Ô∏è Observa√ß√µes Importantes

- O login pode exigir **CAPTCHA manual** ‚Äî o script pausa at√© o usu√°rio completar.
- Se j√° houver um `auth.json` v√°lido, o login manual ser√° pulado automaticamente.
- Utilize **intervalos (sleep)** e **timeouts** apropriados para evitar bloqueios do sistema.
- √â necess√°rio acesso √† rede interna da Vivo para o sistema `OSP Control`.

---

## üßæ Licen√ßa

Este projeto √© de uso interno e educativo, sem fins comerciais.

---

## üë®‚Äçüíª Autor

**GeovaneTelemont**  
Automa√ß√£o de processos com Python + Playwright
